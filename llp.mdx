---
title: "LLP"
description: "Learn about PayStream's LLP (Liquidity Layer Protocol) features."
---

```mermaid
flowchart TD
    %% Entry Point
    A[Start - Telegram Bot Interface]
    
    %% Lender Flow
    A --> B[Lender]
    B --> B1[Deposit Funds in Lending Pool]
    B1 --> B2[Interest Earned per Block]
    B2 --> B3[Interest Distributed Proportionally]
    B1 --> B4[Utilization Ratio Enforced - Max M%]
    B1 --> E1[0.05 SOL Rent Fee - Refundable]
    E1 --> E2[Min 0.2 SOL Recommended]
    
    %% Investor Flow
    A --> C[Investor]
    C --> C1[Choose Investment Method]
    C1 --> C2{Manual or Auto}
    C2 -->|Manual| C3[Select Pool & Invest]
    C2 -->|Auto| C4[Select Wallet to Copy]
    C4 --> C5[Set Max Leverage Cap]
    C3 --> C6[Swap SOL into Pool Tokens]
    C5 --> C6
    C6 --> C7[Invest into DLMM or DAMM V2 Pool]
    C7 --> C8[Optional: Enable Rebalancing]
    C8 --> C9[Maintain Token Ratio]
    C9 --> C10[Rebalancing Fees Apply]
    
    %% Leverage Path (Only if Leverage is Used)
    C7 --> L1{Leverage Used?}
    L1 -->|Yes| L2[Calculate LTV]
    L2 --> L3[Monitor LTV Threshold]
    L3 --> L4{LTV > Threshold?}
    L4 -->|Yes| L11[Alert User - Liquidation Risk]
    L11 --> L12{User Action}
    L12 -->|No Action| L5[Trigger Partial Liquidation]
    L12 -->|Deposit More Funds| L13[Add Margin to Position]
    L13 --> L14[Recalculate LTV]
    L14 --> L10[Continue Monitoring]
    L5 --> L6{Risk Persists?}
    L6 -->|Yes| L7[Trigger Full Liquidation]
    L4 -->|No| L10[Continue Monitoring]
    L2 --> L8{Pool Utilization High?}
    L8 -->|Yes| L9[Deleveraging All Positions]
    
    %% Fees Note
    C6 --> E1
    
    %% Meteora Integration
    C6 --> F[Meteora Integration]
    F --> F1[Token Swap]
    F --> F2[Pool Participation]
    F --> F3[DLMM / DAMM V2 Support]
```

---

### Lenders

- Lenders deposit funds into the **lending pool**.
- The lending pool maintains a **maximum utilization ratio (M%)** to ensure health and availability of funds.
- **Interest** is earned by lenders based on the amount lent and utilization of the pool.
- Interest paid by borrowers is **distributed proportionally** among all lenders based on their share in the pool.
- Interest accrual occurs **per block**.

---

### LP users / Borrowers

- They can invest their own capital or **leverage** their position using funds from the lending pool.
- They bear the risk of **liquidation** based on their **Loan-to-Value (LTV)** ratio.
- Investment can be done in **DLMM** or **DAMM V2** pools.
- They can either:
    1. **Manually invest** in a chosen pool.
    2. Opt for **auto trading** by selecting a wallet to copy. All positions made by the selected wallet will be copied.
- Auto traders can set a **maximum leverage cap** for copied positions.
- Before investing, the user's deposited **SOL will be swapped** into relevant tokens based on the pool.

---

### **Rebalancing (Optional)**

- Users can opt in for **rebalancing**, which manages the token ratios during a position.
- It ensures positions stay within the optimal range, reducing the risk of impermanent loss or liquidation.
- Rebalancing fees apply.

---

### **Liquidation Mechanism**

Applies only when leverage is taken.

- The **liquidation system** is central to protocol risk management.
- It activates when an investorâ€™s **LTV exceeds the threshold**, indicating a risky position.
- Supports:
    - **Partial liquidation** to recover lender funds.
    - **Full liquidation** if risks persist.
    - **Deleveraging** based on overall pool utilization.
    - User can deposit more funds to the position to increase their margin and save themselves from liquidation.

---

### **Fees**

- **Lenders**, **borrowers**, and **investors** are subject to specific fees based on their roles and actions (e.g., rebalancing).
- A **refundable Solana rent fee** is required to open a position on Meteora (~0.05 SOL) and keep the lending/borrowing account.
- A **minimum of 0.2 SOL** is recommended to ensure sufficient balance for operations.

---
